# DeusLibri 執筆ガイド

[English](../WRITING_GUIDE.md)

DeusLibriへようこそ！このガイドでは、電子書籍を執筆・公開する方法を説明します。

## 目次

1. [はじめに](#はじめに)
2. [ファイル構成](#ファイル構成)
3. [メタデータの記述](#メタデータの記述)
4. [本文の執筆](#本文の執筆)
5. [画像の配置](#画像の配置)
6. [公開までの流れ](#公開までの流れ)
7. [ベストプラクティス](#ベストプラクティス)
8. [トラブルシューティング](#トラブルシューティング)

---

## はじめに

DeusLibriでは、Markdown形式で書籍を執筆します。GitHubにpushするだけで、自動的に美しい電子書籍サイトが生成されます。

### 必要なもの

- テキストエディタ（VS Code, Atom, Sublime Textなど）
- 基本的なMarkdownの知識
- 表紙画像（推奨: 800x1200px以上のJPG/PNG）

---

## ファイル構成

書籍は以下の構造で配置します：

```
content/books/
└── YYYY-MM/              # 出版年月（例: 2025-12）
    └── {book-id}/        # 書籍の一意なID（例: my-first-novel）
        └── {lang}/       # 言語コード（ja, en, zh など）
            ├── metadata.yml      # 書籍のメタデータ
            ├── content.md        # 本文
            └── images/           # 画像フォルダ
                ├── cover.jpg     # 表紙画像（必須）
                ├── illustration-01.jpg
                └── illustration-02.jpg
```

### 例: 2025年12月に日本語の小説を公開する場合

```
content/books/
└── 2025-12/
    └── mystery-novel-001/
        └── ja/
            ├── metadata.yml
            ├── content.md
            └── images/
                ├── cover.jpg
                └── scene-01.jpg
```

---

## メタデータの記述

`metadata.yml`ファイルには、書籍の情報を記述します。

### 基本テンプレート

```yaml
# 必須項目
id: "mystery-novel-001"
title: "真夜中の謎"
author: "山田太郎"
publishDate: "2025-12"
language: "ja"
tags:
  - "ミステリー"
  - "サスペンス"
summary: "静かな田舎町で起きた連続殺人事件。若き刑事は真相に辿り着けるのか？"
description: |
  真夜中の謎は、現代日本を舞台にした本格ミステリー小説です。
  平和な田舎町で突如として起きた連続殺人事件。
  新米刑事の主人公が、複雑に絡み合う人間関係を解きほぐし、
  驚愕の真相に迫ります。
recommendText: "本格ミステリーが好きな方、緻密なトリックと人間ドラマを楽しみたい方におすすめです。"
coverImage: "./images/cover.jpg"

# オプション項目
pageCount: 320              # ページ数（概算）
estimatedReadingTime: 240   # 読書時間（分）
isbn: ""                    # ISBNがあれば記入
series: "田舎町ミステリー"   # シリーズ名
seriesNumber: 1             # シリーズ番号
```

### 各項目の説明

| 項目 | 必須 | 説明 | 例 |
|------|------|------|-----|
| `id` | ✓ | 書籍の一意な識別子（半角英数字とハイフン） | `"mystery-novel-001"` |
| `title` | ✓ | 書籍のタイトル | `"真夜中の謎"` |
| `author` | ✓ | 著者名 | `"山田太郎"` |
| `publishDate` | ✓ | 出版年月（YYYY-MM形式） | `"2025-12"` |
| `language` | ✓ | 言語コード（ja, en, zh等） | `"ja"` |
| `tags` | ✓ | ジャンル・タグ（配列形式） | `["ミステリー", "サスペンス"]` |
| `summary` | ✓ | 短い要約（1-2文） | `"静かな田舎町で..."` |
| `description` | ✓ | 詳細な説明（複数行可） | `"真夜中の謎は..."` |
| `recommendText` | ✓ | おすすめ文 | `"本格ミステリーが好きな方..."` |
| `coverImage` | ✓ | 表紙画像のパス | `"./images/cover.jpg"` |
| `pageCount` | - | ページ数 | `320` |
| `estimatedReadingTime` | - | 読書時間（分） | `240` |
| `isbn` | - | ISBN番号 | `"978-4-XXXX-XXXX-X"` |
| `series` | - | シリーズ名 | `"田舎町ミステリー"` |
| `seriesNumber` | - | シリーズ第何作目か | `1` |

### タグの選び方

読者が見つけやすいように、適切なタグを3-5個選びましょう。

**ジャンル例**:
- 文学: `文芸`, `純文学`, `エッセイ`, `詩`
- エンターテイメント: `ミステリー`, `SF`, `ファンタジー`, `ホラー`, `恋愛`, `歴史`
- ノンフィクション: `ビジネス`, `自己啓発`, `科学`, `歴史`, `哲学`, `技術書`
- 対象読者: `児童向け`, `YA`, `一般向け`, `大人向け`

---

## 本文の執筆

`content.md`ファイルに、Markdown形式で本文を執筆します。

### 基本的なMarkdown記法

```markdown
# 第1章 事件の始まり

## 1. 静かな朝

静かな朝だった。田舎町の小さな駅前には、いつものように人影が少ない。

**太字**や*斜体*を使って強調できます。

> 引用文はこのように表示されます。
> セリフなどに使えます。

- リスト項目1
- リスト項目2
- リスト項目3

1. 番号付きリスト
2. 2番目の項目
3. 3番目の項目
```

### ページ区切り

ページの区切りを入れたい場合は、水平線を使用します：

```markdown
第1章の内容...

---

# 第2章 新たな展開

第2章の内容...
```

水平線（`---`）が「ページ送り」モードでのページ区切りとして扱われます。

### 画像の挿入

本文中に画像を挿入する場合：

```markdown
![駅前の風景](./images/illustration-01.jpg)
```

**画像のキャプション付き**:

```markdown
![駅前の風景](./images/illustration-01.jpg)
*図1: 事件が起きた駅前の様子*
```

### 数式の挿入

DeusLibriではKaTeXを使用したLaTeX形式の数式をサポートしています。

**インライン数式**: ドル記号1つ `$...$` で囲みます

```markdown
有名な方程式 $E = mc^2$ はエネルギーと質量の関係を示しています。
```

**ディスプレイ数式**: ドル記号2つ `$$...$$` で囲みます

```markdown
二次方程式の解の公式:

$$
x = \frac{-b \pm \sqrt{b^2 - 4ac}}{2a}
$$
```

**注意**: 縦書きモードでも、数式は自動的に横書きで正しく表示されます。

### 縦書き対応の注意点

日本語書籍では縦書き表示がサポートされます。以下の点に注意してください：

1. **句読点**: 全角の句読点（、。）を使用
2. **記号**: 三点リーダー（…）、ダッシュ（―）などは全角を使用
3. **括弧**: 縦書きで正しく表示される括弧を使用
4. **英数字**: 半角英数字は縦書き時に横向きになる可能性があるため、全角推奨

### 章立ての推奨構造

```markdown
# 第1章 タイトル

## 1. セクション1

本文...

## 2. セクション2

本文...

---
page-break
---

# 第2章 タイトル

## 1. セクション1

本文...
```

見出しレベル:
- `# `（h1）: 章タイトル
- `## `（h2）: セクション・場面
- `### `（h3）: サブセクション（必要に応じて）

---

## 画像の配置

### 表紙画像（必須）

- **ファイル名**: `cover.jpg` または `cover.png`
- **推奨サイズ**: 800x1200px 以上
- **アスペクト比**: 2:3（縦長）
- **形式**: JPEG（ファイルサイズ小）またはPNG（高品質）
- **ファイルサイズ**: 500KB以下推奨

### 挿絵・イラスト

- **命名規則**: `illustration-01.jpg`, `scene-01.jpg` など分かりやすい名前
- **推奨幅**: 1200px以上（自動的に最適化されます）
- **形式**: JPEG推奨（写真・複雑な画像）、PNG（シンプルな図・透過が必要な場合）
- **ファイルサイズ**: 各500KB以下推奨

### 画像最適化のヒント

画像サイズを小さくするには：

1. **JPEG品質を調整**: 80-90%程度で十分な品質
2. **リサイズ**: 必要以上に大きな画像は避ける
3. **オンラインツール使用**: TinyPNG, Squoosh などで圧縮

---

## 公開までの流れ

### Step 1: フォルダ作成

```bash
# 出版年月のフォルダを作成
mkdir -p content/books/2025-12

# 書籍IDのフォルダを作成
mkdir -p content/books/2025-12/my-novel

# 言語フォルダと画像フォルダを作成
mkdir -p content/books/2025-12/my-novel/ja/images
```

### Step 2: ファイルを作成

1. `metadata.yml` を作成し、書籍情報を記入
2. `content.md` を作成し、本文を執筆
3. 表紙画像を `images/cover.jpg` に配置
4. 必要に応じて挿絵を配置

### Step 3: ローカルで確認（オプション）

```bash
# 開発サーバーを起動（プロジェクトのセットアップが必要）
npm run dev
```

ブラウザで `http://localhost:3000` にアクセスして確認します。

### Step 4: GitHubにpush

```bash
# 変更をステージング
git add content/books/2025-12/my-novel

# コミット
git commit -m "Add: 新しい書籍『my-novel』を追加"

# プッシュ
git push origin main
```

### Step 5: 自動デプロイ

GitHub Actionsが自動的に以下を実行します：

1. 書籍データの読み込みと検証
2. 検索インデックスの生成
3. 静的サイトのビルド
4. デプロイ

数分後、サイトに新しい書籍が表示されます。

---

## ベストプラクティス

### 執筆のヒント

1. **定期的に保存・コミット**: こまめにGitでバージョン管理
2. **プレビューで確認**: 本文の見た目を確認しながら執筆
3. **一貫性のあるスタイル**: 章立て、表記ルールを統一
4. **読みやすさ重視**: 段落は短めに、適度な改行を

### メタデータのヒント

1. **魅力的なsummary**: 読者を惹きつける短い要約を
2. **具体的なtags**: 読者が検索しやすいタグを選ぶ
3. **正確なestimatedReadingTime**: 文字数 ÷ 600（1分あたりの読書文字数）で計算

### 画像のヒント

1. **著作権に注意**: 自分で撮影・作成した画像、または使用許可のある画像のみ使用
2. **alt属性を記述**: 画像の内容を説明する代替テキストを必ず記入
3. **ファイル名は英数字**: 日本語ファイル名は避ける

### 多言語対応

同じ書籍を複数言語で提供する場合：

```
content/books/2025-12/my-novel/
├── ja/              # 日本語版
│   ├── metadata.yml
│   ├── content.md
│   └── images/
│       └── cover.jpg
├── en/              # 英語版
│   ├── metadata.yml
│   ├── content.md
│   └── images/
│       └── cover.jpg
└── zh/              # 中国語版
    ├── metadata.yml
    ├── content.md
    └── images/
        └── cover.jpg
```

各言語版で`metadata.yml`と`content.md`を翻訳します。
画像は共有することも、言語ごとに用意することもできます。

---

## トラブルシューティング

### Q: 書籍がサイトに表示されない

**確認事項**:
- [ ] フォルダ構造が正しいか（`content/books/YYYY-MM/{id}/{lang}/`）
- [ ] `metadata.yml`の書式が正しいか（YAMLの文法エラーがないか）
- [ ] 必須項目がすべて記入されているか
- [ ] `coverImage`のパスが正しいか
- [ ] GitHub Actionsのビルドが成功しているか（リポジトリのActionsタブで確認）

### Q: 画像が表示されない

**確認事項**:
- [ ] 画像ファイルが`images/`フォルダに存在するか
- [ ] ファイル名が正しいか（大文字小文字を区別）
- [ ] パスの記述が正しいか（`./images/cover.jpg`）
- [ ] 画像形式がサポートされているか（JPG, PNG, GIF, WebP）

### Q: YAMLのエラーが出る

**よくある間違い**:

```yaml
# ❌ 間違い: コロンの後にスペースがない
title:"真夜中の謎"

# ✅ 正しい: コロンの後にスペース
title: "真夜中の謎"

# ❌ 間違い: インデントが不正
tags:
- "ミステリー"
  - "サスペンス"  # インデントが深すぎる

# ✅ 正しい: インデントを揃える
tags:
  - "ミステリー"
  - "サスペンス"

# ❌ 間違い: 複数行の文字列に引用符
description: "これは
複数行の説明です"

# ✅ 正しい: パイプ記号を使う
description: |
  これは
  複数行の説明です
```

### Q: 縦書きで表示がおかしい

**確認事項**:
- [ ] 全角句読点を使用しているか
- [ ] 半角英数字が多用されていないか（縦書き時は全角推奨）
- [ ] 特殊な記号が正しく表示されているか

### Q: ページ区切りが効かない

**正しい記述**:

```markdown
第1章の内容

---

第2章の内容
```

- `---`の前後に空行を入れる
- ハイフンは3つ
- 水平線が自然なページ区切りとして機能します

---

## サンプル書籍

サンプル書籍が `content/books/2025-12/sample-book/` に用意されています。
参考にしてください。

---

## ヘルプ・サポート

質問や問題がある場合：

1. **GitHub Issues**: [リポジトリのIssues](https://github.com/your-repo/issues)で質問
2. **ドキュメント**: [プロジェクト計画書](./PROJECT_PLAN.md)を参照
3. **コミュニティ**: Discordサーバー（準備中）

---

## 執筆を楽しんでください！

DeusLibriであなたの作品を世界中の読者に届けましょう。
ハッピーライティング！

---

最終更新: 2025-12-04
